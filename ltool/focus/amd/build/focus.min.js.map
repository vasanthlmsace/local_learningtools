{"version":3,"sources":["../src/focus.js"],"names":["define","$","Ajax","LearningToolFocus","focusMode","self","focusInfo","document","querySelector","disableButton","classList","contains","remove","addEventListener","focusBlock","focusModeAction","removeFocusMode","add","addFocusMode","focushovercolor","getAttribute","focusfontcolor","style","background","color","prototype","element","focusCssUrl","focusCssLink","querySelectorAll","setAttribute","loadEnableFocusmode","loadDisableFocusmode","body","status","call","methodname","args","done","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Focus ltool define js.\r\n * @module   ltool_focus\r\n * @copyright 2021, bdecent gmbh bdecent.de\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\n define(['jquery', 'core/ajax'],\r\n function($, Ajax) {\r\n\r\n    /**\r\n     * Controls focus tool action.\r\n     * @param {int} focusMode\r\n     */\r\n    var LearningToolFocus = function(focusMode) {\r\n        var self = this;\r\n        var focusInfo = document.querySelector(\".ltoolfocus-info #ltoolfocus-action\");\r\n        if (focusMode) {\r\n            if (self.disableButton) {\r\n                if (self.disableButton.classList.contains('d-none')) {\r\n                    self.disableButton.classList.remove('d-none');\r\n                }\r\n            }\r\n        }\r\n\r\n        if (focusInfo) {\r\n            focusInfo.addEventListener(\"click\", function() {\r\n                var focusBlock = document.querySelector('.ltoolfocus-info');\r\n                if (focusBlock) {\r\n                    if (focusBlock.classList.contains('enable')) {\r\n                        focusBlock.classList.remove('enable');\r\n                        self.focusModeAction(0);\r\n                        self.removeFocusMode();\r\n                    } else {\r\n                        focusBlock.classList.add('enable');\r\n                        self.focusModeAction(1);\r\n                        self.addFocusMode(focusBlock);\r\n                    }\r\n                }\r\n            });\r\n\r\n            // Hover color.\r\n            var focushovercolor = focusInfo.getAttribute(\"data-hovercolor\");\r\n            var focusfontcolor = focusInfo.getAttribute(\"data-fontcolor\");\r\n            if (focushovercolor && focusfontcolor) {\r\n                focusInfo.addEventListener(\"mouseover\", function() {\r\n                    document.querySelector('#ltoolfocus-action p').style.background = focushovercolor;\r\n                    document.querySelector('#ltoolfocus-action p').style.color = focusfontcolor;\r\n                });\r\n            }\r\n        }\r\n\r\n        if (self.disableButton) {\r\n            self.disableButton.addEventListener(\"click\", function() {\r\n                self.focusModeAction(0);\r\n                self.removeFocusMode();\r\n            });\r\n        }\r\n    };\r\n\r\n    LearningToolFocus.prototype.disableButton = document.querySelector('#page-wrapper #disable-focusmode');\r\n\r\n    LearningToolFocus.prototype.addFocusMode = function(element) {\r\n        var self = this;\r\n        var focusCssUrl = element.getAttribute('data-focuscssurl');\r\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\r\n        if (focusCssLink) {\r\n            focusCssLink.setAttribute('href', focusCssUrl);\r\n        }\r\n        self.loadEnableFocusmode();\r\n    };\r\n\r\n    LearningToolFocus.prototype.removeFocusMode = function() {\r\n        var self = this;\r\n        var focusCssLink = document.querySelectorAll(\"#page-header link#ltool-focuscss\")[0];\r\n        if (focusCssLink) {\r\n            focusCssLink.setAttribute('href', \"\");\r\n        }\r\n\r\n        var focusBlock = document.querySelector('.ltoolfocus-info');\r\n        if (focusBlock.classList.contains('enable')) {\r\n            focusBlock.classList.remove('enable');\r\n        }\r\n        self.loadDisableFocusmode();\r\n    };\r\n\r\n    LearningToolFocus.prototype.loadDisableFocusmode = function() {\r\n        var self = this;\r\n        if (self.disableButton) {\r\n            if (!self.disableButton.classList.contains('d-none')) {\r\n                self.disableButton.classList.add('d-none');\r\n            }\r\n        }\r\n    };\r\n\r\n    LearningToolFocus.prototype.loadEnableFocusmode = function() {\r\n        var self = this;\r\n        // Implemented the focus disable button.\r\n        var body = document.querySelector(\"body\");\r\n        if (body) {\r\n            if (!body.classList.contains('drawer-open-left')) {\r\n                body.classList.remove('drawer-open-left');\r\n            }\r\n        }\r\n        if (self.disableButton) {\r\n            self.disableButton.classList.remove('d-none');\r\n        }\r\n    };\r\n\r\n    LearningToolFocus.prototype.focusModeAction = function(status) {\r\n        Ajax.call([{\r\n            methodname: 'ltool_focus_save_userfocusmode',\r\n            args: {status: status},\r\n            done: function() {\r\n                return true;\r\n            }\r\n        }]);\r\n    };\r\n\r\n    return {\r\n        init: function(focusMode) {\r\n            return new LearningToolFocus(focusMode);\r\n        }\r\n    };\r\n\r\n });"],"file":"focus.min.js"}